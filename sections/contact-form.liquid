{{ 'section-contact-form.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  .section-{{ section.id }} .contact-form__card {
    background-color: {{ section.settings.form_background_color }};
  }
{%- endstyle -%}

<section class="contact-section section-{{ section.id }} section-{{ section.id }}-padding color-{{ section.settings.color_scheme }}">
  <div class="contact-wrapper page-width">
    {%- comment -%} Left Column - Page Content {%- endcomment -%}
    <div class="contact-info">
      {%- if page.content != blank -%}
        <div class="contact-info__content rte">
          {{ page.content }}
        </div>
      {%- endif -%}
    </div>

    {%- comment -%} Right Column - Form {%- endcomment -%}
    <div class="contact-form__card">
      {%- form 'contact', id: 'ContactForm', class: 'contact-form' -%}
        {%- if form.posted_successfully? -%}
          <div class="form-status form-status--success">
            {{ 'icon-success.svg' | inline_asset_content }}
            <p>{{ 'templates.contact.form.post_success' | t }}</p>
          </div>
        {%- elsif form.errors -%}
          <div class="form-status form-status--error">
            {{ 'icon-error.svg' | inline_asset_content }}
            <p>{{ 'templates.contact.form.error_heading' | t }}</p>
          </div>
        {%- endif -%}

        {%- for block in section.blocks -%}
          {%- case block.type -%}

            {%- when 'text_field' -%}
              <div class="contact-form__field {% if block.settings.half_width %}contact-form__field--half{% endif %}" {{ block.shopify_attributes }}>
                <label for="ContactForm-{{ block.id }}">
                  {{ block.settings.label }}{% if block.settings.required %}*{% endif %}
                </label>
                <input
                  type="{{ block.settings.input_type }}"
                  id="ContactForm-{{ block.id }}"
                  name="contact[{{ block.settings.label }}]"
                  {% if block.settings.placeholder != blank %}placeholder="{{ block.settings.placeholder }}"{% endif %}
                  {% if block.settings.required %}required{% endif %}
                  {% if block.settings.input_type == 'email' %}autocomplete="email"{% endif %}
                  {% if block.settings.input_type == 'tel' %}autocomplete="tel" pattern="[0-9\-\+\(\)\s]*"{% endif %}
                >
              </div>

            {%- when 'textarea' -%}
              <div class="contact-form__field contact-form__field--full" {{ block.shopify_attributes }}>
                <label for="ContactForm-{{ block.id }}">
                  {{ block.settings.label }}{% if block.settings.required %}*{% endif %}
                </label>
                <textarea
                  id="ContactForm-{{ block.id }}"
                  name="contact[{{ block.settings.label }}]"
                  rows="{{ block.settings.rows }}"
                  {% if block.settings.placeholder != blank %}placeholder="{{ block.settings.placeholder }}"{% endif %}
                  {% if block.settings.required %}required{% endif %}
                ></textarea>
              </div>

            {%- when 'select' -%}
              <div class="contact-form__field contact-form__field--full" {{ block.shopify_attributes }}>
                <label for="ContactForm-{{ block.id }}">
                  {{ block.settings.label }}{% if block.settings.required %}*{% endif %}
                </label>
                <div class="contact-form__select-wrapper">
                  <select
                    id="ContactForm-{{ block.id }}"
                    name="contact[{{ block.settings.label }}]"
                    {% if block.settings.required %}required{% endif %}
                  >
                    <option value="" disabled selected>{{ block.settings.placeholder }}</option>
                    {%- assign options = block.settings.options | split: ',' -%}
                    {%- for option in options -%}
                      <option value="{{ option | strip }}">{{ option | strip }}</option>
                    {%- endfor -%}
                  </select>
                  <svg class="contact-form__select-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                </div>
              </div>

          {%- endcase -%}
        {%- endfor -%}

        <div class="contact-form__submit">
          <button type="submit" class="contact-form__button">
            {{ section.settings.button_label }}
          </button>
        </div>
      {%- endform -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Contact Form",
  "tag": "section",
  "class": "section-contact-form",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "header",
      "content": "Form Settings"
    },
    {
      "type": "color",
      "id": "form_background_color",
      "label": "Form background color",
      "default": "#D9D9D9"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Submit button label",
      "default": "Submit"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 36
    }
  ],
  "blocks": [
    {
      "type": "text_field",
      "name": "Text Field",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "Name"
        },
        {
          "type": "text",
          "id": "placeholder",
          "label": "Placeholder"
        },
        {
          "type": "select",
          "id": "input_type",
          "label": "Input type",
          "options": [
            { "value": "text", "label": "Text" },
            { "value": "email", "label": "Email" },
            { "value": "tel", "label": "Phone" }
          ],
          "default": "text"
        },
        {
          "type": "checkbox",
          "id": "required",
          "label": "Required",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "half_width",
          "label": "Half width (desktop)",
          "default": false
        }
      ]
    },
    {
      "type": "textarea",
      "name": "Textarea",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "Message"
        },
        {
          "type": "text",
          "id": "placeholder",
          "label": "Placeholder"
        },
        {
          "type": "range",
          "id": "rows",
          "label": "Rows",
          "min": 3,
          "max": 10,
          "step": 1,
          "default": 5
        },
        {
          "type": "checkbox",
          "id": "required",
          "label": "Required",
          "default": false
        }
      ]
    },
    {
      "type": "select",
      "name": "Dropdown",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "Location"
        },
        {
          "type": "text",
          "id": "placeholder",
          "label": "Placeholder",
          "default": "Select Location"
        },
        {
          "type": "textarea",
          "id": "options",
          "label": "Options (comma separated)",
          "default": "Vancouver, Burnaby, Richmond"
        },
        {
          "type": "checkbox",
          "id": "required",
          "label": "Required",
          "default": false
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Contact Form",
      "blocks": [
        {
          "type": "text_field",
          "settings": {
            "label": "First Name",
            "required": true,
            "half_width": true
          }
        },
        {
          "type": "text_field",
          "settings": {
            "label": "Last Name",
            "required": true,
            "half_width": true
          }
        },
        {
          "type": "text_field",
          "settings": {
            "label": "Phone",
            "input_type": "tel",
            "required": true
          }
        },
        {
          "type": "text_field",
          "settings": {
            "label": "Email",
            "input_type": "email",
            "required": true
          }
        },
        {
          "type": "textarea",
          "settings": {
            "label": "Message",
            "required": true
          }
        },
        {
          "type": "select",
          "settings": {
            "label": "Location",
            "placeholder": "Select Location",
            "options": "Vancouver, Burnaby, Richmond"
          }
        }
      ]
    }
  ]
}
{% endschema %}
